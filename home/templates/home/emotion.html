<!DOCTYPE html>
<html lang="en">
{% include "home/header.html" %}
<body>
  <div class="container">
    {% include "home/navi.html" with title=videoFile menu="Emotional Changes Graph" %}
    <div class="row">
      <div class="col-md-4">
        {% include "home/tab.html" %}
      </div>
      <div class="col-md-8">
 	<div class=container id="container">
        </div>
      </div>
    </div>
  </div>
</body>
</html>
<style>
  #container {
    background: none;
    min-width: 310px;
    max-width: 800px;
    height: 400px;
    margin: 0 auto
  }
</style>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/series-label.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script>

$(document).ready(function(){
  $.ajax({
    url : '/emotion',
    type : 'GET',
    data : {
      'videoFile': '{{ videoFile }}',
      'metadata': '{{ metadata }}',
      'character_id': {{ character_id }},
      'csrfmiddlewaretoken': '{{ csrf_token }}'
    },
    dataType:'json',
    success : function(data) {
      Highcharts.chart('container', {
        title: {
          text: "Character {{ character_id }}'s emotional changes"
        },
        subtitle: {
          text: 'powered by Emotion API'
        },
        yAxis: {
          title: {
            text: 'score'
          }
        },
        legend: {
          layout: 'vertical',
          align: 'right',
          verticalAlign: 'middle'
        },
        plotOptions: {
          series: {
            label: {
              connectorAllowed: false
            },
            pointStart: 0
          }
        },
        chart: {
          backgroundColor: 'transparent',
        },
        series: data.emotions,
        responsive: {
          rules: [{
            condition: {
              maxWidth: 500
            },
            chartOptions: {
              legend: {
                layout: 'horizontal',
                align: 'center',
                verticalAlign: 'bottom'
              }
            }
          }]
        }
      });
    },
    error : function(request,error)
    {
        alert("Request: "+JSON.stringify(request));
    }
  });
})
</script>
